<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./src/index.css" />
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Permanent+Marker&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.5.4/dist/aframe-extras.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-physics-system@v4.2.2/dist/aframe-physics-system.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.7/dist/gsap.min.js"></script>
    <script>
      gsap.registerPlugin();
    </script>
    <title>Let Him Quizz</title>
  </head>
  <body style="margin: 0; overflow: hidden">
    <div
      class="flex h-screen w-screen flex-col items-center justify-center gap-10 bg-slate-100"
    >
      <h1 class="mb-40 text-center font-title text-7xl text-black">
        Let Him Quizz
      </h1>
      <div id="loading" class="text-center text-2xl text-black">Loading...</div>
      <div id="progress-bar-container">
        <div id="progress-bar"></div>
      </div>
    </div>
    <style>
      #progress-bar-container {
        width: 50%;
        height: 30px;
        background-color: #ccc;
        z-index: 1000;
        border-radius: 5px;
        overflow: hidden;
      }
      #progress-bar {
        width: 0;
        height: 100%;
        background-color: #4d3ae1;
      }
      a-scene {
        display: none;
      }
    </style>
    <script type="module" src="./src/progress.js"></script>
    <a-scene id="mainScene" physics="debug:false;">
      <a-assets timeout="2000"></a-assets>
      <div id="LoadingPage"></div>
      <!-- camera -->
      <a-entity
        id="camera"
        camera=""
        look-controls="enabled: true"
        position="0 2.2 0"
        rotation="0 0 0"
        wasd-controls=""
        vr-mode-ui="enabled: true"
        gamepad-controls="enabled: true; controller: 0;"
      ></a-entity>
      <script>
        document.addEventListener("gamepadconnected", (event) => {
          const camera = document.querySelector("#camera");
          const gamepad = navigator.getGamepads()[event.gamepad.index];

          function updateCamera() {
        const axes = gamepad.axes;
        const speed = 0.1;

        // Move camera based on joystick input
        camera.object3D.position.x += axes[0] * speed;
        camera.object3D.position.z += axes[1] * speed;

        requestAnimationFrame(updateCamera);
          }

          updateCamera();
        });
      </script>

      <!-- ambient light -->
      <a-light
        class="ambient"
        type="ambient"
        color="#ffffff"
        intensity="0.3"
        position="5.82373 119.06988 -24.14106"
      ></a-light>

      <a-light
        class="light spot"
        type="point"
        color="#ffffff"
        intensity="1"
        position="5.82373 119.06988 -24.14106"
      ></a-light>
      <a-light
        class="light spot"
        type="point"
        color="#ffffff"
        intensity="0.5"
        position="5.82373 16.31798 42.8702"
      ></a-light>

      <!-- tv -->
      <a-entity
        gltf-model="./src/assets/modele3d/tv.glb"
        position="5.94 4.28 -25"
        scale="40 40 40"
        rotation="0
         269.09000000000003 0
         "
      ></a-entity>

      <!-- beer -->
      <a-entity
        gltf-model="./src/assets/modele3d/beer.glb"
        position="-22.0848 -5.36063 12.97207"
        scale="0.5 0.5 0.5"
        rotation="0 269.09000000000003 0"
      ></a-entity>

      <!-- room -->
      <a-entity
        gltf-model="./src/assets/modele3d/room.glb"
        position="5.94 -22.45 -25"
        scale="25 25 25"
        rotation="0 269.09000000000003 0"
      ></a-entity>

      <!-- table -->
      <a-entity
        gltf-model="./src/assets/modele3d/table.glb"
        position="1.21 -14.6 -29.76"
        scale="30 30 40"
        rotation=""
        material="metalness: 0; roughness: 1; shader: standard"
      ></a-entity>

      <!-- sofa -->
      <a-entity
        gltf-model="./src/assets/modele3d/sofa.glb"
        position="24.39 -23.35 5"
        scale="50 50 50"
        rotation=""
      ></a-entity>

      <!-- stage -->
      <a-entity
        gltf-model="./src/assets/modele3d/stage.glb"
        position="1.23833 -1.63184 -37.98841"
        scale="0.67 0.69 0.44"
        rotation=""
      ></a-entity>

      <!-- anchor -->
      <a-entity
        gltf-model="./src/assets/modele3d/man.glb"
        position="8.8 0.2031 -39.14591"
        scale="0.75 0.75 0.75"
        rotation="-0.4 -40 2.4"
        gltf-model="#monster"
        animation-mixer="clip: Man_Clapping;"
      ></a-entity>

      <!-- money drop table -->
      <a-entity
        gltf-model="./src/assets/modele3d/moneydroptable.glb"
        position="8.8 0.2031 -39.14591"
        scale="0.75 0.75 0.75"
        rotation="0 90 0"
        material="metalness: 1; roughness: 1; specular: #fff; shader: standard"
      ></a-entity>
      <!-- FPS counter -->
      <a-entity
        id="fps-counter"
        position="0 2 -3"
        text="value: 0 FPS; color: #FFF; width: 4;"
      ></a-entity>
      <script>
        const fpsCounter = document.querySelector("#fps-counter");
        let lastFrameTime = performance.now();
        let frameCount = 0;

        function updateFPS() {
          const now = performance.now();
          frameCount++;
          if (now >= lastFrameTime + 1000) {
            const fps = frameCount;
            fpsCounter.setAttribute("text", "value", `${fps} FPS`);
            frameCount = 0;
            lastFrameTime = now;
          }
          requestAnimationFrame(updateFPS);
        }

        updateFPS();
      </script>
      <a-sky color="#808080"></a-sky>
      <!-- cylinder for money -->
      <!-- it has 4 hit boxes on the sides and one on the floor -->
      <a-cylinder
        position="-4.525 2.600 -40.62386"
        radius="0.7"
        height="1.5"
        color="#0000FF"
        scale="2.2 3 2.2"
        material="opacity: 0.5; color: #d1d1ff"
        body="type: static; shape: none;"
        shape__side1="shape: box; halfExtents: 0.5 1.5 0.05; offset: 0 0 0.5;"
        shape__side2="shape: box; halfExtents: 0.5 1.5 0.05; offset: 0 0 -0.5;"
        shape__side3="shape: box; halfExtents: 0.05 1.5 0.5; offset: 0.5 0 0;"
        shape__side4="shape: box; halfExtents: 0.05 1.5 0.5; offset: -0.5 0 0;"
        shape__bottom="shape: cylinder; height: 0.05; radiusTop: 0.5; radiusBottom: 0.5; offset: 0 -0.75 0;"
      ></a-cylinder>

      <!-- screen -->
      <a-box
        position="0.99 3.22 -41.45168"
        rotation=""
        width="1"
        height="1"
        depth="1"
        color="#475cff"
        scale="8 5 1"
        id="ecran"
      ></a-box>

      <!-- stage light -->
      <a-entity
        gltf-model="./src/assets/modele3d/spot.glb"
        position="8.84924 7.47002 -33.78025"
        scale="0.75 0.75 0.75"
        rotation="-0.4 180 2.4"
      ></a-entity>

      <a-light
        class="light spot"
        type="point"
        color="#b3b3ff"
        intensity="1"
        position="0.94658 6.536 -35.71878"
      ></a-light>

      <!-- stage floor -->
      <a-plane
        position="1.28077 -1.43517 -32.99556"
        rotation="-90 0 0"
        width="100"
        height="100"
        color="#000000"
        scale="0.23 0.2 1"
        material="metalness: 0; roughness: 1; shader: standard"
      ></a-plane>

      <!-- audiance -->
      <a-entity
        gltf-model="./src/assets/audiance/Chicken_guy.glb"
        position="10.2 -1.5 -24.8"
        scale="1.3 1.4 1.3"
        rotation="0 -150 0"
      ></a-entity>
      <a-entity
        gltf-model="./src/assets/audiance/Citizen_1.glb"
        position="7.3 -1.5 -24.9"
        scale="1.1 1.2 1.1"
        rotation="0 -160 0"
      ></a-entity>
      <a-entity
        gltf-model="./src/assets/audiance/Citizen_2.glb"
        position="4.1 -1.5 -24.7"
        scale="1.5 1.6 1.5"
        rotation="0 -170 0"
      ></a-entity>

      <a-entity
        gltf-model="./src/assets/audiance/Citizen_3.glb"
        position="-1.2 -1.5 -24.9"
        scale="1.2 1.3 1.2"
        rotation="0 -180 0"
      ></a-entity>
      <a-entity
        gltf-model="./src/assets/audiance/Crypto_Bro.glb"
        position="-4.4 -1.5 -24.8"
        scale="1.4 1.5 1.4"
        rotation="0 -190 0"
      ></a-entity>
      <a-entity
        gltf-model="./src/assets/audiance/Female_Officer.glb"
        position="-7.1 -1.5 -24.9"
        scale="1.3 1.4 1.3"
        rotation="0 -200 0"
      ></a-entity>
      <!-- fin premiere ligne -->
      <a-entity
        gltf-model="./src/assets/audiance/Food_Worker.glb"
        position="11.3 -1.5 -28.1"
        scale="1.1 1.2 1.1"
        rotation="0 -120 0"
      ></a-entity>
      <a-entity
        gltf-model="./src/assets/audiance/Generic_Female.glb"
        position="8.1 -1.5 -28.2"
        scale="1.5 1.6 1.5"
        rotation="0 -130 0"
      ></a-entity>
      <a-entity
        gltf-model="./src/assets/audiance/Generic_Male.glb"
        position="5.4 -1.5 -28.3"
        scale="1.2 1.3 1.2"
        rotation="0 -140 0"
      ></a-entity>

      <a-entity
        gltf-model="./src/assets/audiance/Male_Officer.glb"
        position="-2.1 -1.5 -28.1"
        scale="1.4 1.5 1.4"
        rotation="0 -210 0"
      ></a-entity>
      <a-entity
        gltf-model="./src/assets/audiance/Prisoner.glb"
        position="-5.2 -1.5 -28.2"
        scale="1.3 1.4 1.3"
        rotation="0 -220 0"
      ></a-entity>
      <a-entity
        gltf-model="./src/assets/audiance/Retail_Worker.glb"
        position="-8.4 -1.5 -28.3"
        scale="1.1 1.2 1.1"
        rotation="0 -230 0"
      ></a-entity>
      <!-- fin deuxieme ligne -->

      <a-entity
        gltf-model="./src/assets/audiance/Rubber_Duck.glb"
        position="11.2 -1.5 -30.6"
        scale="1.5 1.6 1.5"
        rotation="0 -110 0"
      ></a-entity>
      <a-entity
        gltf-model="./src/assets/audiance/Santa_Claus.glb"
        position="8.4 -1.5 -30.4"
        scale="1.2 1.3 1.2"
        rotation="0 -120 0"
      ></a-entity>
      <a-entity
        gltf-model="./src/assets/audiance/Snowman.glb"
        position="5.3 -1.5 -30.5"
        scale="1.4 1.5 1.4"
        rotation="0 -130 0"
      ></a-entity>

      <a-entity
        gltf-model="./src/assets/audiance/Citizen_2.glb"
        position="-2.2 -1.5 -30.6"
        scale="1.3 1.4 1.3"
        rotation="0 -210 0"
      ></a-entity>
      <a-entity
        gltf-model="./src/assets/audiance/Citizen_3.glb "
        position="-5.3 -1.5 -30.4"
        scale="1.1 1.2 1.1"
        rotation="0 -220 0"
      ></a-entity>
      <a-entity
        gltf-model="./src/assets/audiance/Citizen_1.glb"
        position="-8.1 -1.5 -30.5"
        scale="1.5 1.6 1.5"
        rotation="0 -230 0"
      ></a-entity>
      <!-- fin troisieme ligne -->

      <a-entity
        gltf-model="./src/assets/audiance/Citizen_1.glb"
        position="11.1 -1.5 -33.1"
        scale="1.2 1.3 1.2"
        rotation="0 -110 0"
      ></a-entity>
      <a-entity
        gltf-model="./src/assets/audiance/Crypto_Bro.glb"
        position="8.3 -1.5 -33.2"
        scale="1.4 1.5 1.4"
        rotation="0 -120 0"
      ></a-entity>
      <a-entity
        gltf-model="./src/assets/audiance/Retail_Worker.glb"
        position="5.2 -1.5 -33.3"
        scale="1.3 1.4 1.3"
        rotation="0 -130 0"
      ></a-entity>

      <a-entity
        gltf-model="./src/assets/audiance/Generic_Female.glb"
        position="-2.3 -1.5 -33.1"
        scale="1.1 1.2 1.1"
        rotation="0 -210 0"
      ></a-entity>
      <a-entity
        gltf-model="./src/assets/audiance/Food_Worker.glb"
        position="-5.4 -1.5 -33.2"
        scale="1.5 1.6 1.5"
        rotation="0 -220 0"
      ></a-entity>
      <a-entity
        gltf-model="./src/assets/audiance/Female_Officer.glb"
        position="-8.2 -1.5 -33.3"
        scale="1.2 1.3 1.2"
        rotation="0 -230 0"
      ></a-entity>
    </a-scene>

    <script type="module" src="./src/main.js"></script>
  </body>
</html>
